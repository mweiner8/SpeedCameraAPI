# Speed Camera API

RESTful API for managing speed camera data across the country, built with FastAPI and PostgreSQL.

## ğŸš€ Features

- **GET** cameras by zipcode
- **GET** cameras by street name and zipcode  
- **POST** create new cameras (with duplicate prevention)
- **PUT** update existing cameras
- **DELETE** remove cameras
- Automatic Swagger/OpenAPI documentation
- PostgreSQL database support
- Sample data pre-loaded

## ğŸ“‹ API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/cameras/zipcode/{zipcode}` | Get all cameras in a zipcode |
| GET | `/cameras/search?street=X&zipcode=Y` | Search by street and zipcode |
| POST | `/cameras` | Create a new camera |
| PUT | `/cameras/{camera_id}` | Update a camera |
| DELETE | `/cameras/{camera_id}` | Delete a camera |

## ğŸ› ï¸ Local Development Setup

### Prerequisites
- Python 3.9+
- pip

### Installation

1. **Clone or create project directory**
```bash
mkdir speed-camera-api
cd speed-camera-api
```

2. **Create virtual environment**
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

3. **Install dependencies**
```bash
pip install -r requirements.txt
```

4. **Run the application**
```bash
uvicorn main:app --reload
```

5. **Access the API**
- API: http://localhost:8000
- Swagger Docs: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc
- OpenAPI Spec (auto-generated): http://localhost:8000/openapi.json

## ğŸ“ Example API Usage

### Get cameras by zipcode
```bash
curl http://localhost:8000/cameras/zipcode/10001
```

### Search by street and zipcode
```bash
curl "http://localhost:8000/cameras/search?street=5th%20Ave&zipcode=10001"
```

### Create a new camera
```bash
curl -X POST http://localhost:8000/cameras \
  -H "Content-Type: application/json" \
  -d '{
    "cross_street_1": "7th Ave",
    "cross_street_2": "W 50th St",
    "zipcode": "10019",
    "speed_limit": 25,
    "direction": "N"
  }'
```

### Update a camera
```bash
curl -X PUT http://localhost:8000/cameras/1 \
  -H "Content-Type: application/json" \
  -d '{
    "speed_limit": 30
  }'
```

### Delete a camera
```bash
curl -X DELETE http://localhost:8000/cameras/1
```

## ğŸŒ Deployment to Render

### Option 1: Using render.yaml (Recommended)

1. **Create a GitHub repository** with your code

2. **Push all files to GitHub**
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin <your-repo-url>
git push -u origin main
```

3. **Deploy on Render**
   - Go to [render.com](https://render.com) and sign up/login
   - Click "New +" â†’ "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml` and create:
     - PostgreSQL database
     - Web service connected to the database

4. **Wait for deployment** (takes 5-10 minutes)

5. **Access your API**
   - Your API will be at: `https://speed-camera-api.onrender.com`
   - Swagger docs: `https://speed-camera-api.onrender.com/docs`

### Option 2: Manual Setup

1. **Create PostgreSQL Database**
   - Go to Render Dashboard
   - Click "New +" â†’ "PostgreSQL"
   - Name: `speed-camera-db`
   - Create database and copy the **Internal Database URL**

2. **Create Web Service**
   - Click "New +" â†’ "Web Service"
   - Connect your GitHub repository
   - Settings:
     - **Name**: `speed-camera-api`
     - **Environment**: `Python 3`
     - **Build Command**: `pip install -r requirements.txt`
     - **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`

3. **Add Environment Variable**
   - In the web service settings, add:
   - **Key**: `DATABASE_URL`
   - **Value**: Paste the Internal Database URL from step 1

4. **Deploy**
   - Click "Create Web Service"
   - Wait for deployment to complete

## ğŸ“Š Sample Data

The API comes preloaded with 10 speed cameras from major US cities:
- New York City (10001, 10021, 10022)
- Los Angeles (90212, 90028)
- Chicago (60601, 60602)
- San Francisco (94103, 94133)

## ğŸ” Testing with Swagger

Once deployed, navigate to `/docs` to access the interactive Swagger UI where you can:
- View all endpoints and their specifications
- Test API calls directly in the browser
- See request/response examples
- View the auto-generated OpenAPI specification

**Note:** The OpenAPI specification is automatically generated by FastAPI from your code. You can access it at `/openapi.json` or view it in the Swagger UI. The `openapi.yaml` file is the original design specification.

## ğŸ“¦ Project Structure

```
speed-camera-api/
â”œâ”€â”€ main.py              # FastAPI application
â”œâ”€â”€ requirements.txt     # Python dependencies
â”œâ”€â”€ render.yaml          # Render deployment config
â”œâ”€â”€ openapi.yaml         # OpenAPI design specification
â””â”€â”€ README.md            # This file
```

**Note:** The `openapi.json` file is automatically generated by FastAPI at runtime and accessible at the `/openapi.json` endpoint. You don't need a separate file.

## ğŸ”’ Data Validation

- **Zipcode**: Must be exactly 5 digits
- **Speed Limit**: Between 5-85 mph
- **Direction**: N, S, E, W, NE, NW, SE, SW
- **Duplicates**: Prevented by unique combination of cross streets and zipcode

## ğŸ› Troubleshooting

### Local SQLite database for testing
The app uses SQLite locally by default. The database file is `speed_cameras.db`.

### Render deployment issues
- Check logs in Render dashboard
- Ensure `DATABASE_URL` environment variable is set
- Verify PostgreSQL database is running and accessible

### Database connection errors
- Render's PostgreSQL URL format is automatically converted
- Make sure the web service and database are in the same region

## ğŸ“„ License

This project is created for educational purposes.